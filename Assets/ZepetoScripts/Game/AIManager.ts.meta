fileFormatVersion: 2
guid: 3fd7ba2eb1daa45488f05670ff91c22c
importerOverride: ZEPETO.Script.Compiler:ZEPETO.Script:TypescriptAssetImporter
ScriptedImporter:
  internalIDToNameTable: []
  externalObjects: {}
  serializedVersion: 2
  userData: 
  assetBundleName: 
  assetBundleVariant: 
  script: {fileID: -1123457745, guid: 54cf806323ffe4418a4ce4cc63fe6b9d, type: 3}
  isAssemblyDeclarations: 0
  assembly: 
  generateAllTypes: 1
  types: []
  generateWrapper: 0
  overrideWrapperTypes: 0
  wrapperTypes: []
  WrapperFilters: []
  wrapperOutputDirectory: Generated
  compiledResult: '{"source":"\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\",
    { value: true });\r\nconst UnityEngine_1 = require(\"UnityEngine\");\r\nconst
    ZEPETO_Character_Controller_1 = require(\"ZEPETO.Character.Controller\");\r\nconst
    ZEPETO_Script_1 = require(\"ZEPETO.Script\");\r\nconst MultiplayManager_1 = require(\"../MultiplaySync/Common/MultiplayManager\");\r\nconst
    ZepetoGameCharacter_1 = require(\"./ZepetoGameCharacter\");\r\nclass AIManager
    extends ZEPETO_Script_1.ZepetoScriptBehaviour {\r\n    constructor() {\r\n       
    super(...arguments);\r\n        this.AICharacters = [];\r\n        this._AICount
    = 0;\r\n    }\r\n    Start() {\r\n        ZEPETO_Character_Controller_1.ZepetoPlayers.instance.OnAddedLocalPlayer.AddListener(()
    => {\r\n            this.room = MultiplayManager_1.default.instance.room;\r\n           
    this.Init();\r\n        });\r\n    }\r\n    Init() {\r\n        this.room.AddMessageHandler(\"CheckMaster\",
    (MasterClientSessionId) => {\r\n            if (this.room.SessionId == MasterClientSessionId)
    {\r\n                if (!this.isMasterClient) {\r\n                    this.isMasterClient
    = true;\r\n                }\r\n            }\r\n            else {\r\n           
    }\r\n        });\r\n        this.room.AddMessageHandler(\"GameStart\", (message)
    => {\r\n            this._AICount = message;\r\n        });\r\n        this.room.AddMessageHandler(\"FirstSyncAI\",
    (message) => {\r\n            this.StartCoroutine(this.SpawnAI(message));\r\n       
    });\r\n        this.room.AddMessageHandler(\"AIdestination\", (message) => {\r\n           
    if (this.AICharacters[message.AInumber]?.CurrentState == ZEPETO_Character_Controller_1.CharacterState.Idle\r\n               
    && this.AICharacters[message.AInumber]?.GetComponent($typeof(ZepetoGameCharacter_1.default)).motionState
    == ZepetoGameCharacter_1.MotionState.Idle)\r\n                this.StartCoroutine(this.MoveAI(message.AInumber,
    message));\r\n        });\r\n        this.room.AddMessageHandler(\"OnEndGame\",
    (message) => {\r\n            this.StopAllCoroutines();\r\n            this.StartCoroutine(this.DestroyAllAI());\r\n       
    });\r\n    }\r\n    *SpawnAI(receiveAI) {\r\n        this.AICharacters = [];\r\n       
    for (let i = 0; i < this._AICount; i++) {\r\n            const spawnInfo = new
    ZEPETO_Character_Controller_1.SpawnInfo();\r\n            const position = new
    UnityEngine_1.Vector3(receiveAI[i].PosX, 0, receiveAI[i].PosZ);\r\n           
    const rotation = new UnityEngine_1.Vector3(0, receiveAI[i].RotY, 0);\r\n           
    spawnInfo.position = position;\r\n            spawnInfo.rotation = UnityEngine_1.Quaternion.Euler(rotation);\r\n           
    $extension(\"ZEPETO.Character.Controller.ZepetoPlayersExtension\").CreatePlayerWithUserId(ZEPETO_Character_Controller_1.ZepetoPlayers.instance,
    receiveAI[i].SessionId, \"\", spawnInfo, false);\r\n        }\r\n        for
    (let i = 0; i < this._AICount; i++) {\r\n            yield new UnityEngine_1.WaitUntil(()
    => ZEPETO_Character_Controller_1.ZepetoPlayers.instance.HasPlayer(receiveAI[i].SessionId));\r\n           
    const aiPlayer = ZEPETO_Character_Controller_1.ZepetoPlayers.instance.GetPlayer(receiveAI[i].SessionId);\r\n           
    this.AICharacters.push(aiPlayer.character);\r\n            this.AICharacters[i].tag
    = \"AI\";\r\n            this.AICharacters[i].name = receiveAI[i].SessionId;\r\n           
    let zepetoGameCharacter = this.AICharacters[i].transform.gameObject.AddComponent($typeof(ZepetoGameCharacter_1.default));\r\n           
    zepetoGameCharacter.sessionID = receiveAI[i].SessionId;\r\n        }\r\n       
    //ready AI Send\r\n        this.room.Send(\"ReadyAI\");\r\n    }\r\n    *MoveAI(i,
    AIdestination) {\r\n        if (AIdestination.Stop) {\r\n            this.AICharacters[i].StopMoving();\r\n       
    }\r\n        else {\r\n            let StopSign = false;\r\n            while
    (!StopSign) {\r\n                const newposition = new UnityEngine_1.Vector3(AIdestination.nexPosX,
    0, AIdestination.nexPosZ);\r\n                var moveDir = UnityEngine_1.Vector3.op_Subtraction(newposition,
    this.AICharacters[i].transform.position);\r\n                moveDir = new UnityEngine_1.Vector3(moveDir.x,
    0, moveDir.z);\r\n                if (moveDir.magnitude < 0.05) {\r\n                   
    this.AICharacters[i].StopMoving();\r\n                    StopSign = true;\r\n               
    }\r\n                else {\r\n                    this.AICharacters[i].MoveContinuously(moveDir);\r\n               
    }\r\n                yield new UnityEngine_1.WaitForSeconds(0.1);\r\n           
    }\r\n        }\r\n        yield null;\r\n    }\r\n    *DestroyAllAI() {\r\n       
    yield new UnityEngine_1.WaitForSeconds(0.5);\r\n        for (let i = 0; i < this._AICount;
    i++) {\r\n            const zepetoPlayer = ZEPETO_Character_Controller_1.ZepetoPlayers.instance.GetPlayer(\"AI_\"
    + i.toString());\r\n            zepetoPlayer.character.SetGesture(this._dieGesture);\r\n       
    }\r\n        yield new UnityEngine_1.WaitForSeconds(2.5);\r\n        for (let
    i = 0; i < this._AICount; i++)\r\n            ZEPETO_Character_Controller_1.ZepetoPlayers.instance.RemovePlayer(\"AI_\"
    + i.toString());\r\n    }\r\n    ParseVector3(vector3) {\r\n        return new
    UnityEngine_1.Vector3(vector3.x, vector3.y, vector3.z);\r\n    }\r\n}\r\nexports.default
    = AIManager;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQUlNYW5hZ2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQUlNYW5hZ2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsNkNBVXFCO0FBQ3JCLDZFQUFzRztBQUV0RyxpREFBbUQ7QUFFbkQsK0VBQXdFO0FBQ3hFLCtEQUF5RTtBQWdCekUsTUFBcUIsU0FBVSxTQUFRLHFDQUFxQjtJQUE1RDs7UUFFOEIsaUJBQVksR0FBc0IsRUFBRSxDQUFDO1FBSXZELGFBQVEsR0FBVyxDQUFDLENBQUM7SUErRmpDLENBQUM7SUE3RlcsS0FBSztRQUNULDJDQUFhLENBQUMsUUFBUSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUU7WUFDdkQsSUFBSSxDQUFDLElBQUksR0FBRywwQkFBZ0IsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDO1lBQzNDLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNoQixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFTyxJQUFJO1FBQ1IsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxhQUFhLEVBQUUsQ0FBQyxxQkFBcUIsRUFBRSxFQUFFO1lBQ2pFLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUkscUJBQXFCLEVBQUU7Z0JBQzlDLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFO29CQUN0QixJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQztpQkFDOUI7YUFDSjtpQkFBTTthQUVOO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFDSCxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFdBQVcsRUFBRSxDQUFDLE9BQWUsRUFBRSxFQUFFO1lBQ3pELElBQUksQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDO1FBQzVCLENBQUMsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxhQUFhLEVBQUUsQ0FBQyxPQUF3QixFQUFFLEVBQUU7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","assetPath":"Assets/ZepetoScripts/Game/AIManager.ts","manifest":{"properties":[{"assembly":"UnityEngine.AnimationModule","name":"_dieGesture","type":"UnityEngine.AnimationClip","isArray":false,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[{"name":"SerializeField","args":[]}]},{"assembly":"ZEPETO.Character.Controller","name":"AICharacters","type":"ZEPETO.Character.Controller.ZepetoCharacter[]","isArray":true,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[{"name":"SerializeField","args":[]}]}],"name":"AIManager","description":""},"isCompiled":true}'
  typescriptHash: ec50aa4909e73beee2bf569d9376b31a
  onlyWriteTrigger: 0
